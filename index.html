<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M√≥dulo Did√°ctico - La Energ√≠a</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Roboto', 'Arial', sans-serif;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 25px;
            box-shadow: 0 25px 70px rgba(0,0,0,0.4);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: #ffffff;
            padding: 60px 40px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            border-bottom: 5px solid #0d7d6e;
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 15px;
            font-weight: 700;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.4);
            letter-spacing: -1px;
        }

        .header p {
            font-size: 1.4em;
            opacity: 0.95;
            font-weight: 500;
        }

        .screen {
            display: none;
            padding: 40px;
            animation: fadeIn 0.5s;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* MEN√ö PRINCIPAL */
        .main-menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 35px;
            padding: 60px 40px;
        }

        .menu-card {
            background: #ffffff;
            border: 2px solid #e1e8ed;
            border-radius: 12px;
            padding: 45px 35px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.07);
            position: relative;
            overflow: hidden;
        }

        .menu-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(40, 167, 69, 0.1) 100%);
            opacity: 0;
            transition: opacity 0.4s;
        }

        .menu-card:hover::before {
            opacity: 1;
        }

        .menu-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 24px rgba(0,0,0,0.15);
            border-color: #0066cc;
        }

        .menu-card .icon {
            font-size: 90px;
            margin-bottom: 25px;
            display: block;
            animation: iconFloat 3s ease-in-out infinite;
            position: relative;
            z-index: 1;
        }

        @keyframes iconFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .menu-card h3 {
            font-size: 2em;
            color: #1e3c72;
            margin-bottom: 18px;
            position: relative;
            z-index: 1;
            font-weight: 600;
        }

        .menu-card p {
            font-size: 1.15em;
            color: #555;
            line-height: 1.7;
            position: relative;
            z-index: 1;
        }

        /* SECCI√ìN TE√ìRICA */
        .theory-nav {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border: 1px solid #e1e8ed;
        }

        .theory-nav h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .indicator-btn {
            display: inline-block;
            padding: 14px 28px;
            background: white;
            border: 3px solid #667eea;
            border-radius: 15px;
            margin: 8px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            font-weight: bold;
            font-size: 16px;
            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.15);
        }

        .indicator-btn:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
        }

        .indicator-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
            transform: scale(1.05);
        }

        .indicator-content {
            display: none;
            background: white;
            padding: 30px;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }

        .indicator-content.active {
            display: block;
        }

        .indicator-content h2 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .indicator-content h3 {
            color: #764ba2;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        .indicator-content p, .indicator-content li {
            line-height: 1.8;
            color: #333;
            font-size: 1.1em;
        }

        .indicator-content ul {
            margin-left: 30px;
            margin-top: 15px;
        }

        .energy-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .energy-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .energy-card h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        /* FORMULARIO ESTUDIANTE */
        .student-form {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            padding: 40px;
            border-radius: 20px;
            margin-bottom: 35px;
            border-left: 6px solid #667eea;
            position: relative;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
            font-size: 17px;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 16px 18px;
            border: 3px solid #e9ecef;
            border-radius: 12px;
            font-size: 17px;
            transition: all 0.3s;
            background: white;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.25);
            transform: translateY(-2px);
        }

        .device-options {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .device-card {
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            padding: 35px 25px;
            width: 220px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            position: relative;
        }

        .device-card::after {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 8px;
            background: rgba(0, 102, 204, 0.05);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .device-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.12);
            border-color: #0066cc;
        }

        .device-card:hover::after {
            opacity: 1;
        }

        .device-card.selected {
            border-color: #28a745;
            background: #f0f9f4;
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.2);
            transform: scale(1.02);
        }

        .device-card.selected::before {
            content: '‚úì';
            position: absolute;
            top: 10px;
            right: 10px;
            background: #28a745;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            z-index: 10;
        }

        .device-card .icon {
            font-size: 70px;
            margin-bottom: 18px;
            display: block;
            position: relative;
            z-index: 1;
        }

        .device-card h4 {
            font-size: 1.3em;
            margin-bottom: 8px;
            color: #333;
            position: relative;
            z-index: 1;
        }

        .device-card p {
            color: #666;
            font-size: 0.95em;
            position: relative;
            z-index: 1;
        }

        /* SECCI√ìN DE GU√çA */
        .guide-section {
            background: white;
            padding: 35px;
            border-radius: 20px;
            margin-bottom: 30px;
            border: 3px solid #e9ecef;
            box-shadow: 0 5px 20px rgba(0,0,0,0.06);
            transition: all 0.3s;
        }

        .guide-section:hover {
            box-shadow: 0 8px 30px rgba(0,0,0,0.1);
            border-color: #667eea;
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 18px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e1e8ed;
        }

        .section-title {
            font-size: 1.6em;
            color: #1e3c72;
            font-weight: 600;
        }

        .speak-btn {
            padding: 8px 16px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(40, 167, 69, 0.2);
            font-weight: 600;
        }

        .speak-btn:hover {
            background: #218838;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }

        .speak-btn:active {
            transform: scale(0.95);
        }

        .speak-btn.speaking {
            background: #dc3545;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.05); }
        }

        .prompt-box {
            background: #2d3748;
            color: #e2e8f0;
            padding: 25px;
            border-radius: 8px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            margin: 20px 0;
            position: relative;
            white-space: pre-wrap;
            line-height: 1.6;
            font-size: 14px;
            border: 1px solid #4a5568;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 8px 15px;
            background: #0066cc;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
        }

        .copy-btn:hover {
            background: #0052a3;
        }

        .btn {
            padding: 18px 45px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-transform: none;
            letter-spacing: 0.3px;
        }

        .btn:active {
            transform: scale(0.95);
        }

        .btn-primary {
            background: #0066cc;
            color: white;
        }

        .btn-primary:hover {
            background: #0052a3;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 102, 204, 0.3);
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(108, 117, 125, 0.3);
        }

        .btn-warning {
            background: #ffc107;
            color: #333;
            font-weight: 600;
        }

        .btn-warning:hover {
            background: #e0a800;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 193, 7, 0.3);
        }

        .ai-links {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .ai-link {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 12px 25px;
            background: #17a2b8;
            color: white;
            text-decoration: none;
            border-radius: 10px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .ai-link:hover {
            background: #138496;
            transform: translateY(-2px);
        }

        .checklist {
            list-style: none;
            padding: 0;
        }

        .checklist li {
            padding: 15px;
            margin: 10px 0;
            background: #f8f9fa;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .checklist input[type="checkbox"] {
            width: 24px;
            height: 24px;
            cursor: pointer;
        }

        textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            resize: vertical;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .highlight-box {
            background: #f0f4f8;
            border-left: 4px solid #0066cc;
            padding: 25px;
            border-radius: 8px;
            margin: 25px 0;
            box-shadow: 0 2px 8px rgba(0, 102, 204, 0.1);
            border: 1px solid #d1dce5;
            border-left: 4px solid #0066cc;
        }

        .highlight-box h4 {
            color: #1e3c72;
            margin-bottom: 12px;
            font-size: 1.2em;
            font-weight: 600;
        }

        .highlight-box p, .highlight-box li {
            color: #4a5568;
            line-height: 1.7;
        }

        /* CONTROLES M√ìVILES */
        .mobile-controls {
            position: fixed;
            bottom: 10px;
            right: 10px;
            display: none;
            flex-direction: column;
            gap: 8px;
            z-index: 1000;
        }

        .mobile-controls.show {
            display: flex;
        }

        .mobile-control-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 3px 12px rgba(0,0,0,0.3);
            transition: all 0.3s;
        }

        .mobile-control-btn:active {
            transform: scale(0.9);
        }

        .mobile-control-btn.start { background: #28a745; color: white; }
        .mobile-control-btn.pause { background: #ffc107; color: #333; }
        .mobile-control-btn.resume { background: #17a2b8; color: white; }
        .mobile-control-btn.stop { background: #dc3545; color: white; }

        /* Controles espec√≠ficos que aparecen al seleccionar dispositivo m√≥vil */
        .device-controls {
            position: absolute;
            right: 30px;
            top: 40px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1200;
        }

        /* Controles flotantes fijos: peque√±os en el lado derecho */
        .device-controls-floating {
            position: fixed;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            display: none;
            flex-direction: column;
            gap: 8px;
            z-index: 1400;
        }
        
        .device-controls-floating .control-btn {
            min-width: 45px;
            padding: 6px 8px;
            font-size: 11px;
        }
        
        @media (max-width: 768px) {
            .device-controls-floating {
                right: 5px;
            }
            .device-controls-floating .control-btn {
                min-width: 35px;
                padding: 4px 5px;
                font-size: 9px;
            }
            
            .device-controls .control-btn {
                min-width: 70px;
                padding: 6px 10px;
                font-size: 11px;
            }
        }

        .device-controls .control-btn {
            min-width: 90px;
            padding: 8px 12px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
        }

        .device-controls .control-start { background: #28a745; color: white; }
        .device-controls .control-pause { background: #ffc107; color: #333; }
        .device-controls .control-resume { background: #17a2b8; color: white; }
        .device-controls .control-stop { background: #dc3545; color: white; }

        /* AYUDA TECLADO */
        .keyboard-help {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.85);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            font-size: 14px;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            display: none;
        }

        .keyboard-help.show {
            display: block;
        }

        .keyboard-help h4 {
            margin: 0 0 10px 0;
            color: #FFD700;
        }

        .keyboard-help kbd {
            background: #667eea;
            padding: 3px 8px;
            border-radius: 5px;
            font-weight: bold;
            margin-right: 5px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: #28a745;
            color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            display: none;
            z-index: 1000;
            animation: slideIn 0.3s;
        }

        .notification.show {
            display: block;
        }

        @keyframes slideIn {
            from { transform: translateX(400px); }
            to { transform: translateX(0); }
        }

        .btn-container {
            text-align: center;
            margin: 30px 0;
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        @media print {
            .btn, .speak-btn, .mobile-controls, .keyboard-help {
                display: none !important;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            .main-menu {
                grid-template-columns: 1fr;
            }
            
            /* Hacer botones m√°s compactos en m√≥vil */
            .btn {
                padding: 8px 16px;
                font-size: 13px;
            }
            
            .speak-btn {
                padding: 5px 10px;
                font-size: 11px;
                border-radius: 15px;
                gap: 5px;
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .btn-container {
                flex-direction: column;
                width: 100%;
            }
            
            .btn-container .btn {
                width: 100%;
            }
            
            .device-card {
                width: 100%;
                max-width: 200px;
            }
            
            .guide-section {
                padding: 20px;
            }
            
            .prompt-box {
                font-size: 12px;
                padding: 15px;
            }
        }

        /* MEJOR SOPORTE T√ÅCTIL PARA M√ìVILES */
        * {
            -webkit-tap-highlight-color: rgba(102, 126, 234, 0.3);
            -webkit-touch-callout: none;
        }

        button, .menu-card, .device-card, .indicator-btn {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            touch-action: manipulation;
        }

        /* Fondo tem√°tico para pantallas de configuraci√≥n (energ√≠a) - paleta amarillo/naranja/blanco con toques verdes */
        #visualSetup, #auditivaSetup {
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #fffaf0 0%, #fff0c2 40%, #ffd19a 100%);
            border-top: 6px solid #ffb84d;
        }

        /* Capa de formas sutiles que sugiere energ√≠a (burbujas y rayos) */
        #visualSetup::before, #auditivaSetup::before {
            content: '';
            position: absolute;
            inset: 0;
            pointer-events: none;
            background-image:
                radial-gradient(circle at 12% 18%, rgba(255,255,255,0.40) 0%, rgba(255,255,255,0.00) 16%),
                radial-gradient(circle at 82% 78%, rgba(255,255,255,0.30) 0%, rgba(255,255,255,0.00) 20%),
                radial-gradient(circle at 50% 50%, rgba(255,255,255,0.16) 0%, rgba(255,255,255,0.00) 34%),
                linear-gradient(90deg, rgba(255,255,255,0.02) 0%, rgba(255,255,255,0.00) 40%, rgba(255,255,255,0.02) 100%);
            background-blend-mode: overlay;
            opacity: 0.98;
            transform: translateZ(0);
            animation: energyDrift 18s linear infinite;
        }

        @keyframes energyDrift {
            0% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-12px) scale(1.02); }
            100% { transform: translateY(0) scale(1); }
        }

        /* Asegurar legibilidad del formulario dentro de estas pantallas */
        #visualSetup .student-form, #auditivaSetup .student-form {
            background: rgba(255,255,255,0.98);
            backdrop-filter: blur(4px);
            border-left: 6px solid #28a745; /* toque verde */
        }

        /* Bot√≥n flotante para volver al men√∫ */
        .floating-home-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            width: 65px;
            height: 65px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(17, 153, 142, 0.5);
            font-size: 28px;
            display: none;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .floating-home-btn:hover {
            transform: scale(1.1) rotate(360deg);
            box-shadow: 0 12px 35px rgba(17, 153, 142, 0.7);
        }

        .floating-home-btn:active {
            transform: scale(0.95);
        }

        .floating-home-btn.show {
            display: flex;
        }

        /* √Årea de im√°genes para actividades */
        .image-upload-container {
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 2px dashed #11998e;
        }

        .image-upload-btn {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .image-upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(17, 153, 142, 0.4);
        }

        .uploaded-images {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .uploaded-image-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .uploaded-image-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            display: block;
        }

        .remove-image-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(220, 53, 69, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .remove-image-btn:hover {
            background: rgba(220, 53, 69, 1);
            transform: scale(1.1);
        }

        @media (max-width: 768px) {
            .floating-home-btn {
                width: 55px;
                height: 55px;
                font-size: 24px;
                bottom: 20px;
                right: 20px;
            }
            
            .uploaded-images {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
            
            .uploaded-image-item img {
                height: 100px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìö M√≥dulo Did√°ctico: La Energ√≠a</h1>
            <p>Educaci√≥n Inclusiva - Octavo A√±o</p>
        </div>

        <!-- MEN√ö PRINCIPAL -->
        <div id="mainMenu" class="screen active">
            <div class="main-menu">
                <div class="menu-card" data-action="showTheory">
                    <div class="icon">üìñ</div>
                    <h3>Secci√≥n Te√≥rica</h3>
                    <p>Contenido educativo sobre las formas de energ√≠a, transformaciones y energ√≠as limpias</p>
                </div>

                <div class="menu-card" data-action="showVisual">
                    <div class="icon">üëÅÔ∏è</div>
                    <h3>Discapacidad Visual</h3>
                    <p>M√≥dulo adaptado con soporte de audio y descripciones detalladas</p>
                </div>

                <div class="menu-card" data-action="showAuditiva">
                    <div class="icon">üëÇ</div>
                    <h3>Discapacidad Auditiva</h3>
                    <p>M√≥dulo adaptado con contenido visual, infograf√≠as y videos subtitulados</p>
                </div>
            </div>
        </div>

        <!-- SECCI√ìN TE√ìRICA -->
        <div id="theorySection" class="screen">
            <div class="theory-nav">
                <h3>Selecciona un Indicador de Aprendizaje:</h3>
                <button class="indicator-btn active" data-indicator="1">üìå Indicador 1: Formas y Transformaciones</button>
                <button class="indicator-btn" data-indicator="2">üìå Indicador 2: Avances Cient√≠ficos</button>
                <button class="indicator-btn" data-indicator="3">üìå Indicador 3: Energ√≠as Limpias</button>
            </div>

            <!-- CONTROLES DE LECTURA PARA TEOR√çA (teclado y pantalla) -->
            <div class="guide-section" style="margin: 15px 0;">
                <div class="section-header">
                    <div class="section-title">üîä Controles de Lectura - Teor√≠a</div>
                    <div style="display:flex;gap:10px;align-items:center;">
                        <button class="speak-btn" data-action="start" id="theoryStart" aria-label="Bot√≥n iniciar lectura">‚ñ∂Ô∏è Iniciar (A)</button>
                        <button class="speak-btn" data-action="pause" id="theoryPause" aria-label="Bot√≥n pausar lectura">‚è∏Ô∏è Pausar (S)</button>
                        <button class="speak-btn" data-action="resume" id="theoryResume" aria-label="Bot√≥n reanudar lectura">‚ñ∂Ô∏è Reanudar (W)</button>
                        <button class="speak-btn" data-action="stop" id="theoryStop" aria-label="Bot√≥n detener lectura">‚èπÔ∏è Detener (D)</button>
                    </div>
                </div>
                <div class="section-content">
                    <p style="color:#555;">Atajos de teclado: A = Iniciar, S = Pausar, W = Reanudar, D = Detener. Estos atajos funcionan cuando no est√°s escribiendo en un campo de texto.</p>
                </div>
            </div>

            <!-- INDICADOR 1 -->
            <div id="indicator1" class="indicator-content active">
                <h2>üîã Indicador 1: Identificar las formas y transformaciones de la energ√≠a</h2>
                
                <div style="text-align: center; margin: 30px 0;">
                    <img src="https://images.unsplash.com/photo-1451187580459-43490279c0fa?w=800" alt="Energ√≠a" style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                </div>
                
                <h3>¬øQu√© es la Energ√≠a?</h3>
                <p>La energ√≠a es la capacidad para realizar un trabajo. Hace posible que toda materia logre moverse o experimentar un cambio. En la vida cotidiana, la energ√≠a ha tomado gran importancia para las actividades humanas. Se mide en Julios (J) y Kilojulios (KJ).</p>

                <div class="highlight-box">
                    <h4>‚öñÔ∏è Ley de Conservaci√≥n de la Energ√≠a</h4>
                    <p><strong>"La energ√≠a no puede crearse ni destruirse, solo se transforma."</strong></p>
                </div>

                <h3>Tipos Principales de Energ√≠a</h3>
                <div class="energy-grid">
                    <div class="energy-card">
                        <img src="imagenes/potencial.jpg" alt="Energ√≠a Potencial" style="width: 100%; height: 150px; object-fit: cover; border-radius: 6px; margin-bottom: 15px;">
                        <h4>‚ö° Energ√≠a Potencial</h4>
                        <p>Energ√≠a almacenada en los cuerpos en reposo. Depende de su masa, fuerza de gravedad y altura.</p>
                    </div>
                    <div class="energy-card">
                        <img src="imagenes/cinetica.jpg" alt="Energ√≠a Cin√©tica" style="width: 100%; height: 150px; object-fit: cover; border-radius: 6px; margin-bottom: 15px;">
                        <h4>üèÉ Energ√≠a Cin√©tica</h4>
                        <p>Energ√≠a de un cuerpo en movimiento. Todos los cuerpos en movimiento poseen energ√≠a cin√©tica. Depende de la masa y velocidad.</p>
                    </div>
                    <div class="energy-card">
                        <img src="imagenes/Electrica.jpg" alt="Energ√≠a El√©ctrica" style="width: 100%; height: 150px; object-fit: cover; border-radius: 6px; margin-bottom: 15px;">
                        <h4>üí° Energ√≠a El√©ctrica</h4>
                        <p>Se manifiesta en un movimiento de cargas el√©ctricas entre dos puntos determinados.</p>
                    </div>
                    <div class="energy-card">
                        <img src="imagenes/quimica.jpg" alt="Energ√≠a Qu√≠mica" style="width: 100%; height: 150px; object-fit: cover; border-radius: 6px; margin-bottom: 15px;">
                        <h4>üß™ Energ√≠a Qu√≠mica</h4>
                        <p>Se manifiesta en una reacci√≥n qu√≠mica, formada por el rompimiento o formaci√≥n de enlaces qu√≠micos.</p>
                    </div>
                    <div class="energy-card">
                        <img src="imagenes/Calorica.jpg" alt="Energ√≠a Cal√≥rica" style="width: 100%; height: 150px; object-fit: cover; border-radius: 6px; margin-bottom: 15px;">
                        <h4>üî• Energ√≠a Cal√≥rica</h4>
                        <p>Se manifiesta por la combusti√≥n de la materia. Producto del aumento de temperatura.</p>
                    </div>
                    <div class="energy-card">
                        <img src="imagenes/Geotermica.jpg" alt="Energ√≠a Geot√©rmica" style="width: 100%; height: 150px; object-fit: cover; border-radius: 6px; margin-bottom: 15px;">
                        <h4>üåã Energ√≠a Geot√©rmica</h4>
                        <p>Se manifiesta en un flujo de calor, producido a partir de procesos internos de la tierra.</p>
                    </div>
                    <div class="energy-card">
                        <img src="imagenes/magnetica.jpg" alt="Energ√≠a Magn√©tica" style="width: 100%; height: 150px; object-fit: cover; border-radius: 6px; margin-bottom: 15px;">
                        <h4>üß≤ Energ√≠a Magn√©tica</h4>
                        <p>Es producida por la atracci√≥n ejercida por la propiedad de los imanes.</p>
                    </div>
                </div>
            </div>

            <!-- INDICADOR 2 -->
            <div id="indicator2" class="indicator-content">
                <h2>üî¨ Indicador 2: Avances cient√≠ficos y tecnol√≥gicos</h2>
                
                <div style="text-align: center; margin: 30px 0;">
                    <img src="https://images.unsplash.com/photo-1532094349884-543bc11b234d?w=800" alt="Tecnolog√≠a y Energ√≠a" style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                </div>
                
                <p><strong>Explicar los avances cient√≠ficos y tecnol√≥gicos relacionados con la aplicaci√≥n de diversas formas de energ√≠a para el uso dom√©stico, industrial y la salud.</strong></p>

                <h3>Aplicaciones de la Energ√≠a</h3>
                <p>La energ√≠a ha sido un gran avance para la vida humana, abarcando el campo de la industria, medicina, el dom√©stico y otros, facilitando la vida del ser humano.</p>

                <div class="energy-grid">
                    <div class="energy-card">
                        <img src="https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=400" alt="Uso Dom√©stico" style="width: 100%; height: 150px; object-fit: cover; border-radius: 6px; margin-bottom: 15px;">
                        <h4>üè† Uso Dom√©stico</h4>
                        <p><strong>Energ√≠a El√©ctrica:</strong> Permite el funcionamiento de aparatos electr√≥nicos como celulares, computadoras facilitando la comunicaci√≥n.</p>
                        <p><strong>Energ√≠a Cal√≥rica:</strong> Aplicaci√≥n en calefacci√≥n y producci√≥n de alimentos.</p>
                    </div>
                    <div class="energy-card">
                        <img src="https://images.unsplash.com/photo-1581094271901-8022df4466f9?w=400" alt="Uso Industrial" style="width: 100%; height: 150px; object-fit: cover; border-radius: 6px; margin-bottom: 15px;">
                        <h4>üè≠ Uso Industrial</h4>
                        <p><strong>Energ√≠a Qu√≠mica:</strong> Esencial en autom√≥viles, aviones y barcos. Producto de la combusti√≥n de le√±a, carb√≥n o petr√≥leo.</p>
                        <p><strong>Energ√≠a Cal√≥rica:</strong> Secado y lavado de producciones industriales.</p>
                    </div>
                    <div class="energy-card">
                        <img src="https://images.unsplash.com/photo-1576091160550-2173dba999ef?w=400" alt="Uso en Salud" style="width: 100%; height: 150px; object-fit: cover; border-radius: 6px; margin-bottom: 15px;">
                        <h4>üè• Uso en Salud</h4>
                        <p><strong>Energ√≠a Magn√©tica:</strong> Resonancia magn√©tica (RM) para im√°genes del cuerpo sin procedimientos invasivos.</p>
                        <p><strong>Energ√≠a El√©ctrica:</strong> Fabricaci√≥n de medicamentos, radioterapia, esterilizaci√≥n de material quir√∫rgico.</p>
                    </div>
                    <div class="energy-card">
                        <img src="https://images.unsplash.com/photo-1616628188859-7a11abb6fcc9?w=400" alt="Energ√≠a Geot√©rmica" style="width: 100%; height: 150px; object-fit: cover; border-radius: 6px; margin-bottom: 15px;">
                        <h4>üåç Energ√≠a Geot√©rmica</h4>
                        <p>Fuente de energ√≠a limpia y sostenible, aprovecha el calor interno de la Tierra para generar electricidad y calefacci√≥n. Contribuye al desarrollo de tecnolog√≠as respetuosas con el ambiente.</p>
                    </div>
                </div>
            </div>

            <!-- INDICADOR 3 -->
            <div id="indicator3" class="indicator-content">
                <h2>üå± Indicador 3: Energ√≠as limpias o amigables con el ambiente</h2>
                
                <div style="text-align: center; margin: 30px 0;">
                    <img src="https://images.unsplash.com/photo-1466611653911-95081537e5b7?w=800" alt="Energ√≠as Limpias" style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                </div>
                
                <p><strong>Valorar el uso de energ√≠as limpias o amigables con el ambiente que contribuyan con el desarrollo de las actividades econ√≥micas del pa√≠s y el cuidado del planeta.</strong></p>

                <h3>¬øQu√© son las Energ√≠as Limpias?</h3>
                <p>Se consideran energ√≠as limpias a las nuevas formas de transformaci√≥n de energ√≠as que tienen como objetivo cuidar el ambiente, reconociendo el impacto medioambiental de la obtenci√≥n de energ√≠as.</p>

                <div class="energy-grid">
                    <div class="energy-card" style="border-left-color: #28a745;">
                        <h4>‚úÖ Energ√≠as Renovables</h4>
                        <ul>
                            <li>Se obtienen de fuentes naturales que se regeneran</li>
                            <li>Reservas ilimitadas e inagotables</li>
                            <li>Energ√≠a sostenible a largo plazo</li>
                            <li><strong>Ejemplos:</strong> Solar, e√≥lica, geot√©rmica, biomasa</li>
                        </ul>
                    </div>
                    <div class="energy-card" style="border-left-color: #dc3545;">
                        <h4>‚ùå Energ√≠as No Renovables</h4>
                        <ul>
                            <li>Fuentes que no se regeneran y se pueden agotar</li>
                            <li>Reservas reducidas y limitadas</li>
                            <li>No es sostenible a largo plazo</li>
                            <li><strong>Ejemplos:</strong> Petr√≥leo, carb√≥n, gas natural, energ√≠a nuclear</li>
                        </ul>
                    </div>
                </div>

                <h3>üá®üá∑ Principales Energ√≠as Limpias de Costa Rica</h3>
                <div class="energy-grid">
                    <div class="energy-card">
                        <img src="imagenes/Geotermica.jpg" alt="Energ√≠a Geot√©rmica" style="width: 100%; height: 150px; object-fit: cover; border-radius: 6px; margin-bottom: 15px;">
                        <h4>üåã Energ√≠a Geot√©rmica</h4>
                        <p>Aprovecha el calor interno de la tierra por medio de gases a altas temperaturas.</p>
                    </div>
                    <div class="energy-card">
                        <img src="https://images.unsplash.com/photo-1466611653911-95081537e5b7?w=400" alt="Energ√≠a E√≥lica" style="width: 100%; height: 150px; object-fit: cover; border-radius: 6px; margin-bottom: 15px;">
                        <h4>üí® Energ√≠a E√≥lica</h4>
                        <p>Proviene del movimiento del viento, obtenida por medio de un aerogenerador.</p>
                    </div>
                    <div class="energy-card">
                        <img src="https://images.unsplash.com/photo-1509391366360-2e959784a276?w=400" alt="Energ√≠a Solar" style="width: 100%; height: 150px; object-fit: cover; border-radius: 6px; margin-bottom: 15px;">
                        <h4>‚òÄÔ∏è Energ√≠a Solar</h4>
                        <p>Se obtiene de la luz solar en forma de radiaci√≥n electromagn√©tica.</p>
                    </div>
                    <div class="energy-card">
                        <img src="https://images.unsplash.com/photo-1616628188859-7a11abb6fcc9?w=400" alt="Energ√≠a Geot√©rmica" style="width: 100%; height: 150px; object-fit: cover; border-radius: 6px; margin-bottom: 15px;">
                        <h4>üåã Energ√≠a Geot√©rmica</h4>
                        <p>Aprovecha el calor interno de la tierra por medio de gases a altas temperaturas.</p>
                    </div>
                    <div class="energy-card">
                        <img src="https://images.unsplash.com/photo-1530836369250-ef72a3f5cda8?w=400" alt="Biomasa" style="width: 100%; height: 150px; object-fit: cover; border-radius: 6px; margin-bottom: 15px;">
                        <h4>üåø Biomasa</h4>
                        <p>Energ√≠a obtenida a partir de materia org√°nica.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- CONFIGURACI√ìN DISCAPACIDAD VISUAL -->
        <div id="visualSetup" class="screen">
            <h2 style="text-align: center; color: #667eea; margin-bottom: 30px;">üëÅÔ∏è Configuraci√≥n - Discapacidad Visual</h2>
            
            <div class="student-form">
                <div class="highlight-box">
                    <h4>üìù Nota para el Docente</h4>
                    <p>Por favor, ayude al estudiante a completar los siguientes datos. Es importante que todos los campos sean llenados antes de continuar.</p>
                </div>

                <div class="form-group">
                    <label for="visualName">Nombre completo del estudiante: *</label>
                    <input type="text" id="visualName" placeholder="Ejemplo: Mar√≠a Gonz√°lez" required>
                </div>

                <div class="form-group">
                    <label for="visualSection">Secci√≥n: *</label>
                    <input type="text" id="visualSection" placeholder="Ejemplo: 8-1" required>
                </div>

                <h3 style="margin-top: 30px; text-align: center;">üì± Selecciona el dispositivo que vas a usar:</h3>
                <div class="device-options" id="visualDeviceOptions">
                    <div class="device-card" data-device="computer" data-type="visual">
                        <div class="icon">üíª</div>
                        <h4>Computadora</h4>
                        <p>Atajos de teclado</p>
                    </div>
                    <div class="device-card" data-device="mobile" data-type="visual">
                        <div class="icon">üì±</div>
                        <h4>Celular/Tablet</h4>
                        <p>Botones t√°ctiles</p>
                    </div>
                </div>

                <div class="device-controls" id="visualDeviceControls" style="display:none;" aria-hidden="true">
                    <button class="control-btn control-start" data-action="start" aria-label="Iniciar lectura">A - Iniciar</button>
                    <button class="control-btn control-pause" data-action="pause" aria-label="Pausar lectura">S - Pausar</button>
                    <button class="control-btn control-resume" data-action="resume" aria-label="Reanudar lectura">W - Reanudar</button>
                    <button class="control-btn control-stop" data-action="stop" aria-label="Detener lectura">D - Detener</button>
                </div>

                <div class="btn-container">
                    <button class="btn btn-secondary" data-screen="mainMenu">‚¨ÖÔ∏è Volver</button>
                    <button class="btn btn-success" data-action="startVisual" id="visualStartBtn" disabled>üöÄ Comenzar</button>
                </div>
            </div>
        </div>

        <!-- CONFIGURACI√ìN DISCAPACIDAD AUDITIVA -->
        <div id="auditivaSetup" class="screen">
            <h2 style="text-align: center; color: #667eea; margin-bottom: 30px;">üëÇ Configuraci√≥n - Discapacidad Auditiva</h2>
            
            <div class="student-form">
                <div class="form-group">
                    <label for="auditivaName">Nombre completo del estudiante: *</label>
                    <input type="text" id="auditivaName" placeholder="Ejemplo: Carlos Ram√≠rez" required>
                </div>

                <div class="form-group">
                    <label for="auditivaSection">Secci√≥n: *</label>
                    <input type="text" id="auditivaSection" placeholder="Ejemplo: 8-2" required>
                </div>

                <h3 style="margin-top: 30px; text-align: center;">üì± Selecciona el dispositivo que vas a usar:</h3>
                <div class="device-options" id="auditivaDeviceOptions">
                    <div class="device-card" data-device="computer" data-type="auditiva">
                        <div class="icon">üíª</div>
                        <h4>Computadora</h4>
                        <p>Pantalla grande</p>
                    </div>
                    <div class="device-card" data-device="mobile" data-type="auditiva">
                        <div class="icon">üì±</div>
                        <h4>Celular/Tablet</h4>
                        <p>T√°ctil</p>
                    </div>
                </div>

                <div class="device-controls" id="auditivaDeviceControls" style="display:none;" aria-hidden="true">
                    <button class="control-btn control-start" data-action="start" aria-label="Iniciar lectura">A - Iniciar</button>
                    <button class="control-btn control-pause" data-action="pause" aria-label="Pausar lectura">S - Pausar</button>
                    <button class="control-btn control-resume" data-action="resume" aria-label="Reanudar lectura">W - Reanudar</button>
                    <button class="control-btn control-stop" data-action="stop" aria-label="Detener lectura">D - Detener</button>
                </div>

                <div class="btn-container">
                    <button class="btn btn-secondary" data-screen="mainMenu">‚¨ÖÔ∏è Volver</button>
                    <button class="btn btn-success" data-action="startAuditiva" id="auditivaStartBtn" disabled>üöÄ Comenzar</button>
                </div>
            </div>
        </div>

        <!-- GU√çA DISCAPACIDAD VISUAL -->
        <div id="visualGuide" class="screen">
            <h2 style="text-align: center; color: #667eea; margin-bottom: 30px;">üëÅÔ∏è M√≥dulo para Discapacidad Visual</h2>
            <p style="text-align: center; margin-bottom: 30px;"><strong>Estudiante:</strong> <span id="visualStudentName"></span> | <strong>Secci√≥n:</strong> <span id="visualStudentSection"></span></p>

            <!-- SECCI√ìN 1: PREPARACI√ìN -->
            <div class="guide-section">
                <div class="section-header">
                    <div class="section-title">1Ô∏è‚É£ Preparaci√≥n Inicial</div>
                    <button class="speak-btn" data-action="speak">üîä Leer</button>
                </div>
                <div class="section-content">
                    <h3>Configuraci√≥n del Entorno.</h3>
                    <ul>
                        <li>El profesor te ayudar√° a iniciar ChatGPT.</li>
                        <li>Aseg√∫rate de que la funci√≥n de voz o el lector de pantalla est√© activado.</li>
                        <li>Confirma que el audio se escuche con claridad.</li>
                    </ul>
                    <h3>Materiales Necesarios,</h3>
                    <ul>
                        <li>Documento que contenga la informaci√≥n.</li>
                        <li>Dispositivo con audio en funcionamiento.</li>
                        <li>Grabadora para tomar notas (opcional).</li>
                    </ul>
                </div>
            </div>

            <!-- SECCI√ìN 2: INDICADOR 1 - FORMAS DE ENERG√çA -->
            <div class="guide-section">
                <div class="section-header">
                    <div class="section-title">2Ô∏è‚É£ Indicador 1: Formas y Transformaciones de Energ√≠a</div>
                    <button class="speak-btn" data-action="speak">üîä Leer</button>
                </div>
                <div class="section-content">
                    <h3>Prompt para la IA:</h3>
                    <p><strong>Copia y pega este texto en ChatGPT:</strong></p>
                    <div class="prompt-box" id="promptVisual1">
<button class="copy-btn" data-copy="promptVisual1">Copiar</button>Hola ChatGPT, soy <span class="student-name-placeholder">[Nombre]</span> un estudiante con discapacidad visual. Necesito que me ayudes a estudiar el tema "La energ√≠a" del m√≥dulo de octavo a√±o de Ciencias Naturales. Por favor, resp√≥ndeme en formato de voz (modo hablante) y utiliza un tono amable, claro y con pausas para que pueda seguirte f√°cilmente.

Ay√∫dame de la siguiente manera:

1. Lectura guiada y explicaciones
- Lee y expl√≠came con tus palabras el contenido sobre La energ√≠a.
- Explica qu√© significa energ√≠a y c√≥mo se mide (Julios y Kilojulios).
- Describe las formas de energ√≠a: potencial, cin√©tica, el√©ctrica, qu√≠mica, cal√≥rica, geot√©rmica y magn√©tica.
- Explica tambi√©n la Ley de conservaci√≥n de la energ√≠a con un ejemplo de la vida cotidiana.
- Termina esta parte con un resumen sencillo para reforzar lo aprendido.
- Dame comparaciones y ejemplos cotidianos para entender mejor cada tipo de energ√≠a. Por ejemplo: "La energ√≠a potencial es como‚Ä¶" o "La energ√≠a cin√©tica se parece a‚Ä¶". Usa ejemplos que pueda imaginar auditivamente: sonidos, acciones o situaciones diarias.

2. Preguntas para repasar
Hazme preguntas orales para comprobar si entend√≠. Incluye:
- Preguntas de respuesta corta
- Preguntas para completar frases
- Una o dos preguntas de razonamiento
Espera mis respuestas antes de continuar y corr√≠geme si me equivoco, con una breve explicaci√≥n hablada.

Recuerda hablarme en voz, despacio y con lenguaje claro. El objetivo es ayudarme a comprender las formas y transformaciones de la energ√≠a en la vida diaria.</div>

                    <div class="ai-links">
                        <a href="https://chat.openai.com/" target="_blank" class="ai-link">
                            ü§ñ Abrir ChatGPT
                        </a>
                        <a href="https://claude.ai/" target="_blank" class="ai-link">
                            ü§ñ Abrir Claude
                        </a>
                    </div>

                    <div class="guide-section">
                        <div class="section-header">
                            <div class="section-title">üìù Anotaciones - Indicador 1 (Visual)</div>
                        </div>
                        <div class="section-content">
                            <textarea id="notesPromptVisual1" placeholder="Anotaciones de la pr√°ctica con la IA..."></textarea>
                            <div class="image-upload-container">
                                <input type="file" id="imageUploadVisual1" accept="image/*" multiple style="display: none;">
                                <button class="image-upload-btn" onclick="document.getElementById('imageUploadVisual1').click()">üì∑ Agregar Im√°genes</button>
                                <div class="uploaded-images" id="imagesVisual1"></div>
                            </div>
                        </div>
                    </div>

                    <h3>Lista de Verificaci√≥n - Indicador 1</h3>
                    <ul class="checklist">
                        <li><input type="checkbox"> Comprend√≠ qu√© es la energ√≠a</li>
                        <li><input type="checkbox"> Distingo la energ√≠a potencial y energ√≠a cin√©tica</li>
                        <li><input type="checkbox"> Puedo detallar los diferentes tipos de energ√≠as</li>
                        <li><input type="checkbox"> Identifico las unidades del Sistema Internacional para medir la energ√≠a</li>
                        <li><input type="checkbox"> Resolv√≠ todas mis dudas</li>
                        <li><input type="checkbox"> Complet√© la evaluaci√≥n</li>
                        <li><input type="checkbox"> Obtuve el resumen final</li>
                    </ul>
                </div>
            </div>

            <!-- SECCI√ìN 3: INDICADOR 2 - AVANCES CIENT√çFICOS -->
            <div class="guide-section">
                <div class="section-header">
                    <div class="section-title">3Ô∏è‚É£ Indicador 2: Avances Cient√≠ficos y Tecnol√≥gicos</div>
                    <button class="speak-btn" data-action="speak">üîä Leer</button>
                </div>
                <div class="section-content">
                    <h3>Prompt para la IA</h3>
                    <p><strong>Copia y pega este texto en ChatGPT:</strong></p>
                    <div class="prompt-box" id="promptVisual2">
<button class="copy-btn" data-copy="promptVisual2">Copiar</button>Hola ChatGPT, soy <span class="student-name-placeholder">[Nombre]</span>, un estudiante con discapacidad visual. Necesito que me ayudes a estudiar el tema "Avances cient√≠ficos y tecnol√≥gicos relacionados con la energ√≠a" del m√≥dulo de octavo a√±o de Ciencias Naturales.

Por favor, resp√≥ndeme en formato de voz (modo hablante), usando un tono amable, claro y con pausas, para que pueda comprenderte f√°cilmente.

Ay√∫dame de la siguiente manera:

1. Lectura guiada y explicaciones
- Explica c√≥mo la energ√≠a ha sido un avance para la vida humana en la industria, medicina y uso dom√©stico
- Describe los avances cient√≠ficos y tecnol√≥gicos en:
  * Uso dom√©stico (energ√≠a el√©ctrica, cal√≥rica)
  * Uso industrial (energ√≠a qu√≠mica, cal√≥rica)
  * Uso en salud (energ√≠a magn√©tica en resonancia magn√©tica, radioterapia)
  * Energ√≠a geot√©rmica como fuente limpia
- Usa ejemplos que pueda imaginar con sonidos, acciones o situaciones de la vida diaria

2. Ejemplos auditivos o cotidianos
Da ejemplos que yo pueda imaginar con sonidos o acciones, como encender una l√°mpara, el sonido de un hospital, una f√°brica funcionando.

3. Resumen final
Al terminar, hazme un resumen sencillo y corto para reforzar lo aprendido.</div>

                    <div class="ai-links">
                        <a href="https://chat.openai.com/" target="_blank" class="ai-link">
                            ü§ñ Abrir ChatGPT
                        </a>
                        <a href="https://claude.ai/" target="_blank" class="ai-link">
                            ü§ñ Abrir Claude
                        </a>
                    </div>

                    <div class="guide-section">
                        <div class="section-header">
                            <div class="section-title">üìù Anotaciones - Indicador 2 (Visual)</div>
                        </div>
                        <div class="section-content">
                            <textarea id="notesPromptVisual2" placeholder="Anotaciones de la pr√°ctica con la IA..."></textarea>
                        </div>
                    </div>

                    <h3>Lista de Verificaci√≥n - Indicador 2</h3>
                    <ul class="checklist">
                        <li><input type="checkbox"> Comprend√≠ las principales formas de energ√≠a: cal√≥rica, qu√≠mica, el√©ctrica, magn√©tica y geot√©rmica</li>
                        <li><input type="checkbox"> Identifiqu√© ejemplos de c√≥mo cada tipo de energ√≠a se aplica en la vida cotidiana y en la industria</li>
                        <li><input type="checkbox"> Reconoc√≠ los avances cient√≠ficos y tecnol√≥gicos que han surgido a partir del uso de diferentes energ√≠as</li>
                        <li><input type="checkbox"> Puedo explicar c√≥mo las diversas formas de energ√≠a contribuyen al bienestar y la salud humana</li>
                        <li><input type="checkbox"> Complet√© la evaluaci√≥n y resolv√≠ mis dudas</li>
                    </ul>
                </div>
            </div>

            <!-- SECCI√ìN 4: INDICADOR 3 - ENERG√çAS LIMPIAS -->
            <div class="guide-section">
                <div class="section-header">
                    <div class="section-title">4Ô∏è‚É£ Indicador 3: Energ√≠as Limpias y Ambiente</div>
                    <button class="speak-btn" data-action="speak">üîä Leer</button>
                </div>
                <div class="section-content">
                    <h3>Prompt para la IA</h3>
                    <p><strong>Copia y pega este texto en ChatGPT:</strong></p>
                    <div class="prompt-box" id="promptVisual3">
<button class="copy-btn" data-copy="promptVisual3">Copiar</button>Hola ChatGPT, soy <span class="student-name-placeholder">[Nombre]</span>, un estudiante con discapacidad visual. Necesito que me ayudes a estudiar el tema "Las energ√≠as limpias y su importancia para el ambiente" del m√≥dulo de octavo a√±o de Ciencias Naturales.

Por favor, resp√≥ndeme en formato de voz (modo hablante), usando un tono amable, claro y con pausas, para que pueda comprenderte f√°cilmente.

Ay√∫dame de la siguiente manera:

1. Lectura guiada y explicaciones
- L√©eme y expl√≠came con tus palabras qu√© son las energ√≠as limpias o amigables con el ambiente
- Explica la diferencia entre energ√≠as renovables y no renovables
- Describe las principales formas de energ√≠as renovables: solar, e√≥lica, hidroel√©ctrica, geot√©rmica y biomasa, usando ejemplos que pueda imaginar con sonidos, acciones o situaciones de la vida diaria
- Explica las energ√≠as no renovables como petr√≥leo, carb√≥n, gas natural y energ√≠a nuclear, diciendo por qu√© no son sostenibles y qu√© problemas causan al ambiente
- Menciona las principales energ√≠as limpias de Costa Rica

2. Ejemplos auditivos o cotidianos
Da ejemplos que yo pueda imaginar con sonidos o acciones, como: "La energ√≠a solar la usamos cuando‚Ä¶", "La energ√≠a e√≥lica funciona cuando el viento‚Ä¶"

3. Resumen final
Al terminar, hazme un resumen sencillo y corto para reforzar lo aprendido.</div>

                    <div class="ai-links">
                        <a href="https://chat.openai.com/" target="_blank" class="ai-link">
                            ü§ñ Abrir ChatGPT
                        </a>
                        <a href="https://claude.ai/" target="_blank" class="ai-link">
                            ü§ñ Abrir Claude
                        </a>
                    </div>

                    <div class="guide-section">
                        <div class="section-header">
                            <div class="section-title">üìù Anotaciones - Indicador 3 (Visual)</div>
                        </div>
                        <div class="section-content">
                            <textarea id="notesPromptVisual3" placeholder="Anotaciones de la pr√°ctica con la IA..."></textarea>
                        </div>
                    </div>

                    <h3>Lista de Verificaci√≥n - Indicador 3</h3>
                    <ul class="checklist">
                        <li><input type="checkbox"> Comprend√≠ el concepto de energ√≠as limpias</li>
                        <li><input type="checkbox"> Identifiqu√© las energ√≠as renovables y no renovables</li>
                        <li><input type="checkbox"> Reconoc√≠ las principales energ√≠as limpias de Costa Rica</li>
                        <li><input type="checkbox"> Puedo debatir las diferencias y similitudes de las energ√≠as renovables y no renovables</li>
                        <li><input type="checkbox"> Complet√© la evaluaci√≥n y resolv√≠ mis dudas</li>
                    </ul>
                </div>
            </div>

            <!-- SECCI√ìN 5: REFLEXI√ìN -->
            <div class="guide-section">
                <div class="section-header">
                    <div class="section-title">5Ô∏è‚É£ Mis Notas y Reflexi√≥n</div>
                    <button class="speak-btn" data-action="speak">üîä Leer</button>
                </div>
                <div class="section-content">
                    <div class="highlight-box">
                        <h4>üí≠ Preguntas para tu reflexi√≥n:</h4>
                        <ul>
                            <li>¬øQu√© fue lo que m√°s te llam√≥ la atenci√≥n sobre el tema de la energ√≠a?</li>
                            <li>¬øQu√© parte te result√≥ m√°s f√°cil o m√°s dif√≠cil de entender?</li>
                            <li>¬øQu√© ejemplos te ayudaron m√°s a comprender las diferencias entre las formas de energ√≠a?</li>
                        </ul>
                    </div>
                    <textarea id="visualNotes" placeholder="Escribe aqu√≠ tus notas y reflexiones..."></textarea>
                </div>
            </div>

            <!-- EVALUACI√ìN DOCENTE -->
            <div class="guide-section">
                <div class="section-header">
                    <div class="section-title">üë®‚Äçüè´ Evaluaci√≥n para el Docente</div>
                    <button class="speak-btn" data-action="speak">üîä Leer</button>
                </div>
                <div class="section-content">
                    <div class="highlight-box">
                        <h4>üìã Prompt para Evaluaci√≥n del Docente</h4>
                        <p>Copie y pegue este prompt en ChatGPT para evaluar el desempe√±o del estudiante:</p>
                    </div>
                    <div class="prompt-box" id="promptVisualEval">
<button class="copy-btn" data-copy="promptVisualEval">Copiar</button>Hola ChatGPT, soy docente de octavo a√±o y necesito que me ayudes a evaluar la interacci√≥n del estudiante con discapacidad visual que utiliz√≥ tu asistencia para estudiar el tema "formas y transformaciones de la energ√≠a".

Por favor, realiza una evaluaci√≥n formativa completa, estructurada en los siguientes apartados:

1. Resumen general de la interacci√≥n
- Realiza un resumen completo del di√°logo o actividad que el estudiante mantuvo contigo
- Describe brevemente c√≥mo se desarroll√≥ la sesi√≥n: introducci√≥n, explicaciones, ejemplos, participaci√≥n, preguntas y reflexiones
- Se√±ala si el estudiante logr√≥ mantener una comunicaci√≥n activa, clara y coherente
- Eval√∫a el nivel de comprensi√≥n y participaci√≥n del estudiante usando una escala (incluye tu r√∫brica si tienes una)
- Incluye una breve justificaci√≥n de la calificaci√≥n

2. Reflexi√≥n sobre el tema
- Analiza si el estudiante logr√≥ reflexionar sobre el tema de la energ√≠a, su importancia y aplicaci√≥n en la vida cotidiana

3. Expresi√≥n y actitud
- Eval√∫a c√≥mo se expres√≥ el estudiante: uso de lenguaje, claridad verbal, capacidad para argumentar
- Considera su actitud hacia el aprendizaje, su disposici√≥n para participar y su aprovechamiento del apoyo de la IA

4. Recomendaciones para el docente
Ofrece sugerencias personalizadas que ayuden al docente a fortalecer el aprendizaje del estudiante:
- Estrategias para reforzar contenidos de energ√≠a
- Actividades adicionales (auditivas o experimentales)
- Recomendaciones para mejorar la comprensi√≥n o la interacci√≥n en futuras sesiones con IA</div>

                    <div class="ai-links">
                        <a href="https://chat.openai.com/" target="_blank" class="ai-link">
                            ü§ñ Abrir ChatGPT para Evaluaci√≥n
                        </a>
                    </div>

                    <h3>Observaciones del Docente:</h3>
                    <textarea id="visualTeacherNotes" placeholder="El docente puede escribir aqu√≠ sus observaciones..."></textarea>
                </div>
            </div>
        </div>

        <!-- GU√çA DISCAPACIDAD AUDITIVA -->
        <div id="auditivaGuide" class="screen">
            <h2 style="text-align: center; color: #1e3c72; margin-bottom: 30px;">üëÇ M√≥dulo para Discapacidad Auditiva</h2>
            
            <p style="text-align: center; margin-bottom: 30px;"><strong>Estudiante:</strong> <span id="auditivaStudentName"></span> | <strong>Secci√≥n:</strong> <span id="auditivaStudentSection"></span></p>

            <!-- SECCI√ìN 1: PREPARACI√ìN -->
            <div class="guide-section">
                <div class="section-header">
                    <div class="section-title">1Ô∏è‚É£ Preparaci√≥n Inicial</div>
                </div>
                <div class="section-content">
                    <div style="text-align: center; margin: 20px 0;">
                        <img src="https://images.unsplash.com/photo-1516321318423-f06f85e504b3?w=600" alt="Preparaci√≥n" style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                    </div>
                    <h3>Configuraci√≥n del Entorno.</h3>
                    <ul>
                        <li>El docente te brindar√° ayuda para iniciar ChatGPT.</li>
                        <li>Aseg√∫rese de que la pantalla est√© lista para leer todo el contenido.</li>
                        <li>Confirma que los textos, subt√≠tulos o mensajes de ChatGPT se vean con claridad.</li>
                    </ul>
                    <h3>Materiales Necesarios.</h3>
                    <ul>
                        <li>Documento que contenga la informaci√≥n.</li>
                        <li>Dispositivo m√≥vil (Computadora, Celular, Tablet).</li>
                        <li>Ten un cuaderno o archivo digital para tomar apuntes (opcional).</li>
                    </ul>
                </div>
            </div>

            <!-- SECCI√ìN 2: INDICADOR 1 - FORMAS DE ENERG√çA -->
            <div class="guide-section">
                <div class="section-header">
                    <div class="section-title">2Ô∏è‚É£ Indicador 1: Formas y Transformaciones de Energ√≠a</div>
                </div>
                <div class="section-content">
                    <h3>Prompt para la IA</h3>
                    <p><strong>Copia y pega este texto en ChatGPT:</strong></p>
                    <div class="prompt-box" id="promptAuditiva1">
<button class="copy-btn" data-copy="promptAuditiva1">Copiar</button>Hola ChatGPT, soy <span class="student-name-placeholder-aud">[Nombre]</span> un estudiante con discapacidad auditiva. Necesito que me ayudes a estudiar el tema "La energ√≠a" del m√≥dulo de octavo a√±o de Ciencias Naturales. Para ello requiero material audiovisual que me permita una buena comprensi√≥n del tema, y poder identificar las formas y transformaciones de la energ√≠a en diferentes actividades, que se realizan en la vida diaria.

1. Recolecci√≥n de informaci√≥n:
Brinda informaci√≥n sobre el tema considerando los siguientes puntos:
- Definici√≥n general de energ√≠a, tipos, sus transformaciones
- Ejemplos de la cotidianidad de las formas de energ√≠a
- Videos con subt√≠tulos: Proporciona enlaces a videos educativos que expliquen el tema, asegur√°ndote de que cuenten con subt√≠tulos claros y legibles
- Lengua de Se√±as: Si es posible, incluye videos en Lengua de Se√±as que expliquen el tema de manera detallada
- Resumen escrito: Elabora un resumen escrito que explique las formas y transformaciones de la energ√≠a, utilizando un lenguaje claro y sencillo
- Brinda fuentes confiables

2. Infograf√≠a
Genera una infograf√≠a visual que incluya:
- Tipos de energ√≠a con iconos
- Ejemplos cotidianos
- Transformaciones de energ√≠a
- Usa colores distintivos para cada tipo</div>

                    <div class="ai-links">
                        <a href="https://chat.openai.com/" target="_blank" class="ai-link">
                            ü§ñ Abrir ChatGPT
                        </a>
                        <a href="https://claude.ai/" target="_blank" class="ai-link">
                            ü§ñ Abrir Claude
                        </a>
                    </div>

                    <div class="guide-section">
                        <div class="section-header">
                            <div class="section-title">üìù Anotaciones - Indicador 1 (Auditiva)</div>
                        </div>
                        <div class="section-content">
                            <textarea id="notesPromptAuditiva1" placeholder="Anotaciones de la pr√°ctica con la IA..."></textarea>
                        </div>
                    </div>

                    <div class="highlight-box">
                        <h4>üé® Actividad: Crea tu Infograf√≠a sobre un Tipo de Energ√≠a</h4>
                        <ol>
                            <li><strong>Selecciona un tipo de energ√≠a:</strong> solar, e√≥lica, hidr√°ulica, t√©rmica, etc.</li>
                            <li><strong>Investiga con ChatGPT:</strong> Pide ayuda para resumir datos importantes (definici√≥n, usos, ventajas, desventajas, ejemplos)</li>
                            <li><strong>Genera un esquema:</strong> Organiza la informaci√≥n en: t√≠tulo, secciones principales y subtemas</li>
                            <li><strong>Dise√±a la infograf√≠a:</strong> Define colores, tipograf√≠a, iconos. Pide sugerencias a ChatGPT</li>
                        </ol>
                    </div>

                    <h3>Lista de Verificaci√≥n - Indicador 1</h3>
                    <ul class="checklist">
                        <li><input type="checkbox"> Comprend√≠ qu√© es la energ√≠a</li>
                        <li><input type="checkbox"> Distingo la energ√≠a potencial y energ√≠a cin√©tica</li>
                        <li><input type="checkbox"> Puedo detallar los diferentes tipos de energ√≠as</li>
                        <li><input type="checkbox"> Identifico las unidades del Sistema Internacional para medir la energ√≠a</li>
                        <li><input type="checkbox"> Resolv√≠ todas mis dudas</li>
                        <li><input type="checkbox"> Complet√© la evaluaci√≥n</li>
                        <li><input type="checkbox"> Dise√±√© una infograf√≠a</li>
                    </ul>
                </div>
            </div>

            <!-- SECCI√ìN 3: INDICADOR 3 - ENERG√çAS LIMPIAS -->
            <div class="guide-section">
                <div class="section-header">
                    <div class="section-title">3Ô∏è‚É£ Indicador 3: Energ√≠as Limpias</div>
                </div>
                <div class="section-content">
                    <h3>Prompt para la IA</h3>
                    <p><strong>Copia y pega este texto en ChatGPT:</strong></p>
                    <div class="prompt-box" id="promptAuditiva2">
<button class="copy-btn" data-copy="promptAuditiva2">Copiar</button>Hola ChatGPT, soy <span class="student-name-placeholder-aud">[Nombre]</span> un estudiante con discapacidad auditiva. Necesito que me ayudes a estudiar el tema "Energ√≠as limpias" del m√≥dulo de octavo a√±o de Ciencias Naturales.

1. Recolecci√≥n de informaci√≥n:
- Definici√≥n general de energ√≠as limpias o amigables con el ambiente, explicando su importancia para el desarrollo sostenible y el cuidado del planeta
- Analizar c√≥mo contribuyen las energ√≠as limpias al desarrollo de las actividades econ√≥micas del pa√≠s (agricultura, industria, transporte, turismo)
- Videos con subt√≠tulos: Proporciona enlaces a videos educativos sobre energ√≠as renovables
- Lengua de Se√±as: Si es posible, incluye videos en Lengua de Se√±as
- Resumen escrito: Elabora un resumen claro sobre energ√≠as renovables vs no renovables

2. Autoevaluaci√≥n
Genera una evaluaci√≥n al nivel de octavo a√±o que incluya:
- 12 preguntas de selecci√≥n √∫nica aproximadamente
- Correspondencia (pareo)
- Cinco preguntas de respuesta corta
- Dos preguntas de respuesta construida</div>

                    <div class="ai-links">
                        <a href="https://chat.openai.com/" target="_blank" class="ai-link">
                            ü§ñ Abrir ChatGPT
                        </a>
                        <a href="https://claude.ai/" target="_blank" class="ai-link">
                            ü§ñ Abrir Claude
                        </a>
                    </div>

                    <div class="guide-section">
                        <div class="section-header">
                            <div class="section-title">üìù Anotaciones - Indicador 3 (Auditiva)</div>
                        </div>
                        <div class="section-content">
                            <textarea id="notesPromptAuditiva2" placeholder="Anotaciones de la pr√°ctica con la IA..."></textarea>
                        </div>
                    </div>

                    <div class="highlight-box">
                        <h4>üèôÔ∏è Proyecto: Ciudad con Energ√≠as Limpias</h4>
                        <p><strong>Crea una infograf√≠a sobre una ciudad costarricense que funcione solo con energ√≠as limpias</strong></p>
                        <ol>
                            <li><strong>Imagina tu ciudad:</strong> Incluye paneles solares, turbinas e√≥licas, transporte el√©ctrico, zonas verdes, r√≠os limpios</li>
                            <li><strong>Investiga con ChatGPT:</strong>
                                <ul>
                                    <li>¬øQu√© tipos de energ√≠a limpia se usan en Costa Rica?</li>
                                    <li>¬øC√≥mo benefician al ambiente y la econom√≠a?</li>
                                    <li>¬øQu√© tecnolog√≠as limpias existen?</li>
                                </ul>
                            </li>
                            <li><strong>Genera un esquema:</strong> Secciones como energ√≠a limpia, transporte sostenible, econom√≠a verde, naturaleza</li>
                            <li><strong>Dise√±a tu infograf√≠a:</strong> Usa colores, iconos e im√°genes representativas</li>
                        </ol>
                    </div>
                </div>
            </div>

            <!-- SECCI√ìN 4: REFLEXI√ìN -->
            <div class="guide-section">
                <div class="section-header">
                    <div class="section-title">4Ô∏è‚É£ Mis Notas y Reflexi√≥n</div>
                </div>
                <div class="section-content">
                    <textarea id="auditivaNotes" placeholder="Escribe aqu√≠ tus notas, observaciones y reflexiones..."></textarea>
                </div>
            </div>

            <!-- EVALUACI√ìN DOCENTE -->
            <div class="guide-section">
                <div class="section-header">
                    <div class="section-title">üë®‚Äçüè´ Evaluaci√≥n para el Docente</div>
                </div>
                <div class="section-content">
                    <div class="highlight-box">
                        <h4>üìã Prompt para Evaluaci√≥n del Docente</h4>
                        <p>Copie y pegue este prompt en ChatGPT para evaluar el desempe√±o del estudiante:</p>
                    </div>
                    <div class="prompt-box" id="promptAuditivaEval">
<button class="copy-btn" data-copy="promptAuditivaEval">Copiar</button>Hola ChatGPT, soy docente de octavo a√±o y necesito que me ayudes a evaluar la interacci√≥n del estudiante con discapacidad auditiva que utiliz√≥ tu asistencia para estudiar el tema "formas y transformaciones de la energ√≠a".

Por favor, realiza una evaluaci√≥n formativa completa, estructurada en los siguientes apartados:

1. Resumen general de la interacci√≥n
- Realiza un resumen completo del di√°logo o actividad que el estudiante mantuvo contigo
- Describe brevemente c√≥mo se desarroll√≥ la sesi√≥n
- Se√±ala si el estudiante logr√≥ mantener una comunicaci√≥n activa, clara y coherente
- Eval√∫a el nivel de comprensi√≥n y participaci√≥n usando una escala
- Incluye una breve justificaci√≥n de la calificaci√≥n

2. Reflexi√≥n sobre el tema
- Analiza si el estudiante logr√≥ reflexionar sobre el tema de la energ√≠a, su importancia y aplicaci√≥n

3. Expresi√≥n y actitud
- Eval√∫a c√≥mo se expres√≥ el estudiante: uso de lenguaje, claridad, capacidad para argumentar
- Considera su actitud hacia el aprendizaje y aprovechamiento del apoyo de la IA

4. Recomendaciones para el docente
- Estrategias para reforzar contenidos de energ√≠a
- Actividades adicionales visuales o experimentales
 - Recomendaciones para mejorar la interacci√≥n en futuras sesiones</div>
                    </div>

                    <div class="guide-section">
                        <div class="section-header">
                            <div class="section-title">üìù Anotaciones - Evaluaci√≥n (Auditiva)</div>
                        </div>
                        <div class="section-content">
                            <textarea id="notesPromptAuditivaEval" placeholder="Anotaciones del docente sobre la evaluaci√≥n..."></textarea>
                        </div>
                    </div>
                </div>
            </div>
            <!-- CIERRE DEL ARCHIVO Y SCRIPTS -->
        </div>
        <!-- FIN DE CONTENIDO PRINCIPAL -->
    </div>

    <!-- Bot√≥n flotante para volver al men√∫ -->
    <button class="floating-home-btn" id="floatingHomeBtn" aria-label="Volver al men√∫ principal">üè†</button>

    <script>
        // ============= MANEJO UNIVERSAL DE EVENTOS PARA M√ìVILES =============
        // Esta funci√≥n agrega event listeners tanto para click como para touch
        function addUniversalListener(element, handler) {
            if (!element) return;
            // Usar addEventListener una sola vez
            element.addEventListener('click', handler, {passive: false});
        }

        // Variable para controlar si ya se inicializaron los listeners
        let listenersInitialized = false;

        // Funci√≥n para inicializar todos los event listeners
        function initializeEventListeners() {
            // Evitar inicializar m√∫ltiples veces
            if (listenersInitialized) return;
            listenersInitialized = true;
            
            // Tarjetas del men√∫ principal
            document.querySelectorAll('.menu-card[data-action]').forEach(card => {
                const handler = function(e) {
                    e.preventDefault();
                    const action = this.getAttribute('data-action');
                    if (action === 'showTheory') showTheorySection();
                    else if (action === 'showVisual') showDisabilityMenu('visual');
                    else if (action === 'showAuditiva') showDisabilityMenu('auditiva');
                };
                card.addEventListener('click', handler);
                card.addEventListener('touchend', handler);
            });

            // Botones de indicadores
            document.querySelectorAll('.indicator-btn[data-indicator]').forEach(btn => {
                const handler = function(e) {
                    e.preventDefault();
                    const indicator = parseInt(this.getAttribute('data-indicator'));
                    if (indicator) showIndicator(indicator);
                };
                btn.addEventListener('click', handler);
                btn.addEventListener('touchend', handler);
            });

            // Botones de acciones
            document.querySelectorAll('button[data-action], .speak-btn[data-action]').forEach(btn => {
                const handler = function(e) {
                    e.preventDefault();
                    const action = this.getAttribute('data-action');
                    if (action === 'start') startReadingCurrent();
                    else if (action === 'pause') pauseReading();
                    else if (action === 'resume') resumeReading();
                    else if (action === 'stop') stopReading();
                    else if (action === 'speak') speakSection(this);
                    else if (action === 'startVisual') startVisualGuide();
                    else if (action === 'startAuditiva') startAuditivaGuide();
                    else if (action === 'print') printVisualGuide();
                };
                btn.addEventListener('click', handler);
                btn.addEventListener('touchend', handler);
            });

            // Botones de navegaci√≥n entre pantallas
            document.querySelectorAll('button[data-screen]').forEach(btn => {
                const handler = function(e) {
                    e.preventDefault();
                    const screen = this.getAttribute('data-screen');
                    if (screen) showScreen(screen);
                };
                btn.addEventListener('click', handler);
                btn.addEventListener('touchend', handler);
            });

            // Tarjetas de dispositivo
            document.querySelectorAll('.device-card[data-device][data-type]').forEach(card => {
                const handler = function(e) {
                    e.preventDefault();
                    const type = this.getAttribute('data-type');
                    if (type === 'visual') selectVisualDevice(this);
                    else if (type === 'auditiva') selectAuditivaDevice(this);
                };
                card.addEventListener('click', handler);
                card.addEventListener('touchend', handler);
            });

            // Botones de copiar prompt
            document.querySelectorAll('button[data-copy]').forEach(btn => {
                const handler = function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('data-copy');
                    if (targetId) copyPrompt(targetId);
                };
                btn.addEventListener('click', handler);
                btn.addEventListener('touchend', handler);
            });
        }

        // Navegaci√≥n entre pantallas
        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            const el = document.getElementById(id);
            if (el) el.classList.add('active');
            
            // Mostrar/ocultar bot√≥n flotante
            const floatingBtn = document.getElementById('floatingHomeBtn');
            if (floatingBtn) {
                if (id === 'mainMenu') {
                    floatingBtn.classList.remove('show');
                } else {
                    floatingBtn.classList.add('show');
                }
            }
            
            // actualizar visibilidad de controles seg√∫n dispositivo seleccionado
            setTimeout(() => {
                try { 
                    updateFloatingDeviceControls();
                } catch(e) {
                    console.error('Error en showScreen:', e);
                }
            }, 100);
        }

        function showTheorySection() {
            showScreen('theorySection');
            showIndicator(1);
        }

        function showDisabilityMenu(type) {
            if (type === 'visual') showScreen('visualSetup');
            else if (type === 'auditiva') showScreen('auditivaSetup');
        }

        // Indicadores en secci√≥n te√≥rica
        function showIndicator(n) {
            document.querySelectorAll('.indicator-btn').forEach((btn, idx) => {
                btn.classList.toggle('active', idx === (n-1));
            });
            document.querySelectorAll('.indicator-content').forEach((c, idx) => {
                c.classList.toggle('active', idx === (n-1));
            });
        }

        // Selecci√≥n de dispositivo - Visual
        let selectedVisualDevice = null;
        function selectVisualDevice(elemOrDevice) {
            let device = typeof elemOrDevice === 'string' ? elemOrDevice : (elemOrDevice?.dataset?.device || null);
            if (!device) return;
            selectedVisualDevice = device;
            document.querySelectorAll('#visualSetup .device-card').forEach(card => {
                card.classList.toggle('selected', card.dataset.device === device);
            });
            updateVisualStartState();
            // mostrar/ocultar controles en pantalla si es mobile
            const ctrl = document.getElementById('visualDeviceControls');
            if (ctrl) {
                if (device === 'mobile') { ctrl.style.display = 'flex'; ctrl.setAttribute('aria-hidden','false'); }
                else { ctrl.style.display = 'none'; ctrl.setAttribute('aria-hidden','true'); }
            }
            // persistir preferencia
            try { localStorage.setItem('preferredDevice', device); } catch(e) {}
            // actualizar controles flotantes
            setTimeout(() => updateFloatingDeviceControls(), 100);
        }

        function updateVisualStartState() {
            const name = document.getElementById('visualName').value.trim();
            const section = document.getElementById('visualSection').value.trim();
            const btn = document.getElementById('visualStartBtn');
            if (name && section && selectedVisualDevice) btn.disabled = false;
            else btn.disabled = true;
        }

        function startVisualGuide() {
            const name = document.getElementById('visualName').value.trim();
            const section = document.getElementById('visualSection').value.trim();
            document.getElementById('visualStudentName').textContent = name;
            document.getElementById('visualStudentSection').textContent = section;
            showScreen('visualGuide');
        }

        // Selecci√≥n de dispositivo - Auditiva
        let selectedAuditivaDevice = null;
        function selectAuditivaDevice(elemOrDevice) {
            let device = typeof elemOrDevice === 'string' ? elemOrDevice : (elemOrDevice?.dataset?.device || null);
            if (!device) return;
            selectedAuditivaDevice = device;
            document.querySelectorAll('#auditivaSetup .device-card').forEach(card => {
                card.classList.toggle('selected', card.dataset.device === device);
            });
            updateAuditivaStartState();
            // mostrar/ocultar controles en pantalla si es mobile
            const ctrl = document.getElementById('auditivaDeviceControls');
            if (ctrl) {
                if (device === 'mobile') { ctrl.style.display = 'flex'; ctrl.setAttribute('aria-hidden','false'); }
                else { ctrl.style.display = 'none'; ctrl.setAttribute('aria-hidden','true'); }
            }
            // persistir preferencia
            try { localStorage.setItem('preferredDevice', device); } catch(e) {}
            // actualizar controles flotantes
            setTimeout(() => updateFloatingDeviceControls(), 100);
        }

        function updateAuditivaStartState() {
            const name = document.getElementById('auditivaName').value.trim();
            const section = document.getElementById('auditivaSection').value.trim();
            const btn = document.getElementById('auditivaStartBtn');
            if (name && section && selectedAuditivaDevice) btn.disabled = false;
            else btn.disabled = true;
        }

        function startAuditivaGuide() {
            const name = document.getElementById('auditivaName').value.trim();
            const section = document.getElementById('auditivaSection').value.trim();
            document.getElementById('auditivaStudentName').textContent = name;
            document.getElementById('auditivaStudentSection').textContent = section;
            showScreen('auditivaGuide');
        }

        // Copiar prompts
        function copyPrompt(id) {
            const el = document.getElementById(id);
            if (!el) return;
            const text = el.innerText.replace(/Copiar\s*/,'').trim();
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text).then(() => {
                    showNotification('Texto copiado al portapapeles');
                }, () => {
                    fallbackCopy(text);
                });
            } else {
                fallbackCopy(text);
            }
        }

        function fallbackCopy(text) {
            const ta = document.createElement('textarea');
            ta.value = text;
            document.body.appendChild(ta);
            ta.select();
            try { document.execCommand('copy'); showNotification('Texto copiado al portapapeles'); }
            catch(e) { alert('No se pudo copiar. Seleccione y copie manualmente.'); }
            document.body.removeChild(ta);
        }

        // Variable global para controlar notificaciones
        let currentNotification = null;

        function showNotification(msg) {
            // Remover notificaci√≥n anterior si existe
            if (currentNotification) {
                currentNotification.remove();
                currentNotification = null;
            }
            
            const n = document.createElement('div');
            n.className = 'notification show';
            n.textContent = msg;
            document.body.appendChild(n);
            currentNotification = n;
            
            setTimeout(() => { 
                if (n.parentNode) {
                    n.classList.remove('show');
                    setTimeout(() => {
                        n.remove();
                        if (currentNotification === n) {
                            currentNotification = null;
                        }
                    }, 300);
                }
            }, 2200);
        }

        // Lectura por voz mejorada (Web Speech API)
        // Implementa inicio, pausa, reanudar y detener completo, manteniendo la posici√≥n por oraciones
        const Speech = {
            utter: null,
            queue: [],
            index: 0,
            isPaused: false,
            isRunning: false,
            onfinish: null,
        };

        // Elemento que actualmente estamos leyendo (para botones en gu√≠as)
        let activeReadTarget = null;
        let activeReadButton = null;

        function cleanText(text) {
            if (!text) return '';
            // Eliminar emojis y s√≠mbolos pictogr√°ficos comunes
            try {
                return text.replace(/([\u{1F300}-\u{1F6FF}]|[\u{1F900}-\u{1F9FF}]|[\u{1F1E6}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}])/gu, '')
                           .replace(/\uFE0F/g,'')
                           .replace(/[\t\u000B\f\r]+/g,' ')
                           .replace(/\s+/g,' ').trim();
            } catch (e) {
                // si el navegador no soporta 'u' flag, hacer limpieza b√°sica
                return text.replace(/[\u2600-\u27BF\u1F300-\u1F6FF]/g,'').replace(/\s+/g,' ').trim();
            }
        }

        function buildTheoryText() {
            const activeIndicator = document.querySelector('.indicator-content.active');
            if (!activeIndicator) return '';
            return activeIndicator.innerText.trim();
        }

        function speakText(text) {
            if (!('speechSynthesis' in window)) {
                showNotification('‚ùå Tu navegador no soporta s√≠ntesis de voz. Prueba con Chrome, Edge o Safari.');
                return;
            }
            if (!text || !text.trim()) {
                showNotification('‚ö†Ô∏è No hay texto para leer');
                return;
            }
            const cleaned = cleanText(text);
            if (!cleaned) {
                showNotification('‚ö†Ô∏è No hay contenido v√°lido para leer');
                return;
            }
            
            // Detener cualquier lectura previa y esperar un momento
            if (window.speechSynthesis.speaking) {
                window.speechSynthesis.cancel();
            }
            
            // Esperar un momento para que se cancele completamente
            setTimeout(() => {
                // cortar por oraciones
                const sentences = cleaned.match(/[^\.\!\?]+[\.\!\?]?/g) || [cleaned];
                Speech.queue = sentences.map(s => s.trim()).filter(Boolean);
                Speech.index = 0;
                Speech.isPaused = false;
                Speech.isRunning = true;
                Speech.onfinish = () => {
                    // limpiar estado UI
                    if (activeReadButton) {
                        activeReadButton.classList.remove('speaking');
                        const originalText = activeReadButton.getAttribute('data-original-text');
                        if (originalText) {
                            activeReadButton.innerHTML = originalText;
                        } else {
                            activeReadButton.innerHTML = 'üîä Leer';
                        }
                    }
                    activeReadTarget = null; 
                    activeReadButton = null;
                    Speech.isRunning = false;
                };
                speakNextFrom(Speech.index);
            }, 100);
        }

        function speakNextFrom(i) {
            if (!Speech.isRunning || Speech.isPaused) return;
            if (i >= Speech.queue.length) {
                Speech.isRunning = false;
                if (typeof Speech.onfinish === 'function') Speech.onfinish();
                return;
            }
            const sentence = Speech.queue[i];
            if (!sentence || !sentence.trim()) {
                Speech.index++;
                speakNextFrom(Speech.index);
                return;
            }
            
            const utter = new SpeechSynthesisUtterance(sentence);
            Speech.utter = utter;
            
            // Seleccionar una voz espa√±ola m√°s clara
            const voices = window.speechSynthesis.getVoices();
            const spanishVoice = voices.find(voice => 
                voice.lang.startsWith('es') && 
                (voice.name.includes('Google') || voice.name.includes('Microsoft'))
            ) || voices.find(voice => voice.lang.startsWith('es'));
            
            if (spanishVoice) {
                utter.voice = spanishVoice;
            }
            
            utter.lang = 'es-ES';
            utter.rate = 0.90;
            utter.pitch = 1.0;
            utter.volume = 1;
            
            utter.onend = () => {
                if (Speech.isPaused || !Speech.isRunning) return;
                Speech.index++;
                // Peque√±o delay entre oraciones para evitar interrupciones
                setTimeout(() => speakNextFrom(Speech.index), 50);
            };
            
            utter.onerror = (event) => {
                // Ignorar error "interrupted" ya que es normal al cambiar de texto
                if (event.error === 'interrupted') {
                    console.log('Lectura interrumpida (normal)');
                    return;
                }
                console.error('Error en s√≠ntesis de voz:', event.error);
                if (event.error !== 'canceled') {
                    showNotification('‚ùå Error en la lectura de voz');
                }
                Speech.isRunning = false;
                if (typeof Speech.onfinish === 'function') Speech.onfinish();
            };
            
            try {
                window.speechSynthesis.speak(utter);
            } catch (error) {
                console.error('Error al intentar hablar:', error);
                showNotification('‚ùå Error al iniciar la voz');
                Speech.isRunning = false;
                if (typeof Speech.onfinish === 'function') Speech.onfinish();
            }
        }

        // iniciar lectura para un elemento (secci√≥n pr√°ctica o teor√≠a)
        function startReadingElement(el, btn) {
            if (!el) {
                showNotification('‚ö†Ô∏è No se encontr√≥ contenido para leer');
                return;
            }
            
            const text = el.innerText || el.textContent || '';
            const cleanedText = text.trim();
            
            if (!cleanedText) {
                showNotification('‚ö†Ô∏è Esta secci√≥n no contiene texto para leer');
                return;
            }
            
            if (cleanedText.length < 10) {
                showNotification('‚ö†Ô∏è El contenido es demasiado corto para leer');
                return;
            }
            
            // si ya se est√° leyendo otra cosa, detener primero
            stopReading(false);
            
            activeReadTarget = el;
            activeReadButton = btn || null;
            
            if (activeReadButton) {
                activeReadButton.classList.add('speaking');
                const originalText = activeReadButton.textContent;
                activeReadButton.setAttribute('data-original-text', originalText);
                activeReadButton.innerHTML = '‚èπÔ∏è Detener';
            }
            
            speakText(text);
            showNotification('üîä Lectura iniciada');
        }

        // Devuelve la secci√≥n .guide-section visible dentro de la pantalla dada (por id)
        function getVisibleSectionInScreen(screenId) {
            const screen = document.getElementById(screenId);
            if (!screen) return null;
            
            // Primero intentar con .guide-section
            let sections = Array.from(screen.querySelectorAll('.guide-section'));
            
            // Si no hay guide-section, buscar otros contenedores con contenido
            if (!sections.length) {
                sections = Array.from(screen.querySelectorAll('.indicator-content, .section-content'));
            }
            
            if (!sections.length) return null;
            
            // Buscar la secci√≥n m√°s visible en el viewport
            let best = null;
            let bestScore = Infinity;
            
            sections.forEach(sec => {
                const r = sec.getBoundingClientRect();
                
                // Calcular qu√© tan visible est√° la secci√≥n
                const visibleTop = Math.max(0, r.top);
                const visibleBottom = Math.min(window.innerHeight, r.bottom);
                const visibleHeight = visibleBottom - visibleTop;
                
                // Si no es visible, ignorar
                if (visibleHeight <= 0) return;
                
                // Preferir secciones m√°s visibles y m√°s arriba
                const score = r.top >= 0 ? r.top : 10000 - visibleHeight;
                
                if (score < bestScore) {
                    bestScore = score;
                    best = sec;
                }
            });
            
            // Si no hay ninguna visible, devolver la primera secci√≥n
            return best || sections[0];
        }

        function startReadingCurrent() {
            const activeScreen = document.querySelector('.screen.active')?.id || '';
            
            if (!activeScreen) {
                showNotification('‚ö†Ô∏è No hay una pantalla activa');
                return;
            }
            
            // Para la secci√≥n te√≥rica
            if (activeScreen === 'theorySection') {
                const textEl = document.querySelector('.indicator-content.active');
                if (!textEl) {
                    showNotification('‚ö†Ô∏è No hay secci√≥n te√≥rica seleccionada. Selecciona un indicador primero.');
                    return;
                }
                const text = (textEl.innerText || textEl.textContent || '').trim();
                if (!text) {
                    showNotification('‚ö†Ô∏è La secci√≥n seleccionada no tiene contenido para leer');
                    return;
                }
                startReadingElement(textEl, document.getElementById('theoryStart'));
                return;
            }
            
            // Para gu√≠as (visualGuide, auditivaGuide u otras)
            const visibleSec = getVisibleSectionInScreen(activeScreen);
            if (visibleSec) {
                const contentEl = visibleSec.querySelector('.section-content') || visibleSec;
                const text = (contentEl.innerText || contentEl.textContent || '').trim();
                
                if (!text) {
                    showNotification('‚ö†Ô∏è No hay contenido de texto en esta secci√≥n');
                    return;
                }
                
                startReadingElement(contentEl, null);
            } else {
                showNotification('‚ö†Ô∏è No se encontr√≥ contenido para leer. Despl√°zate hasta la secci√≥n que quieres escuchar.');
            }
        }

        function pauseReading() {
            if (!Speech.isRunning) return;
            if ('speechSynthesis' in window && window.speechSynthesis.speaking) {
                window.speechSynthesis.pause();
                Speech.isPaused = true;
                if (activeReadButton) activeReadButton.innerHTML = '‚è∏Ô∏è Pausado';
                showNotification('‚è∏Ô∏è Lectura pausada');
            }
        }

        function resumeReading() {
            if (!Speech.isRunning) return;
            if ('speechSynthesis' in window && Speech.isPaused) {
                window.speechSynthesis.resume();
                Speech.isPaused = false;
                if (activeReadButton) activeReadButton.innerHTML = '‚èπÔ∏è Detener';
                showNotification('‚ñ∂Ô∏è Lectura reanudada');
            }
        }

        function stopReading(showMsg = true) {
            // Forzar detenci√≥n completa
            Speech.isRunning = false;
            Speech.isPaused = false;
            Speech.queue = [];
            Speech.index = 0;
            
            if ('speechSynthesis' in window) {
                // Cancelar m√∫ltiples veces para asegurar
                window.speechSynthesis.cancel();
                setTimeout(() => window.speechSynthesis.cancel(), 50);
                setTimeout(() => window.speechSynthesis.cancel(), 100);
            }
            
            if (activeReadButton) {
                activeReadButton.classList.remove('speaking');
                
                // Restaurar el texto original del bot√≥n
                const originalText = activeReadButton.getAttribute('data-original-text');
                if (originalText) {
                    activeReadButton.innerHTML = originalText;
                } else {
                    activeReadButton.innerHTML = 'üîä Leer';
                }
            }
            
            activeReadTarget = null;
            activeReadButton = null;
            
            if (showMsg) showNotification('‚èπÔ∏è Lectura detenida');
        }

        // speakSection para los botones de cada secci√≥n
        function speakSection(btn) {
            // Si este mismo bot√≥n ya est√° activo y hablando, detener
            if (activeReadButton === btn && Speech.isRunning) {
                stopReading();
                return;
            }
            
            // Si hay otra lectura activa, detenerla primero
            if (Speech.isRunning) {
                stopReading(false);
                // Esperar un momento antes de iniciar la nueva lectura
                setTimeout(() => startSectionReading(btn), 200);
                return;
            }
            
            startSectionReading(btn);
        }
        
        function startSectionReading(btn) {
            // Buscar la secci√≥n de contenido
            const sectionHeader = btn.closest('.section-header');
            if (!sectionHeader) {
                showNotification('‚ö†Ô∏è No se encontr√≥ la secci√≥n para leer');
                return;
            }
            
            const section = sectionHeader.nextElementSibling;
            if (!section) {
                showNotification('‚ö†Ô∏è No hay contenido disponible para leer en esta secci√≥n');
                return;
            }
            
            // Obtener el texto
            const text = section.innerText || section.textContent || '';
            if (!text.trim()) {
                showNotification('‚ö†Ô∏è Esta secci√≥n no tiene texto para leer');
                return;
            }
            
            startReadingElement(section, btn);
        }

        // Atajos de teclado A = iniciar lectura de la secci√≥n visible en pantalla, S = pausar, W = reanudar, D = detener
        document.addEventListener('keydown', (e) => {
            const tag = document.activeElement && document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;
            const key = e.key.toLowerCase();
            if (key === 'a') startReadingCurrent();
            else if (key === 's') pauseReading();
            else if (key === 'w') resumeReading();
            else if (key === 'd') stopReading();
        });

        // Controles m√≥viles: botones peque√±os flotantes
        function ensureMobileControls() {
            let mc = document.querySelector('.mobile-controls');
            if (!mc) {
                mc = document.createElement('div');
                mc.className = 'mobile-controls';
                mc.innerHTML = `
                    <button class="mobile-control-btn start" aria-label="Iniciar" title="Iniciar" data-action="start">‚ñ∂Ô∏è</button>
                    <button class="mobile-control-btn pause" aria-label="Pausar" title="Pausar" data-action="pause">‚è∏Ô∏è</button>
                    <button class="mobile-control-btn resume" aria-label="Reanudar" title="Reanudar" data-action="resume">‚ñ∂Ô∏è</button>
                    <button class="mobile-control-btn stop" aria-label="Detener" title="Detener" data-action="stop">‚èπÔ∏è</button>
                `;
                document.body.appendChild(mc);
                
                // Agregar event listeners a los botones
                mc.querySelectorAll('button[data-action]').forEach(btn => {
                    const handler = function(e) {
                        e.preventDefault();
                        const action = this.getAttribute('data-action');
                        if (action === 'start') startReadingCurrent();
                        else if (action === 'pause') pauseReading();
                        else if (action === 'resume') resumeReading();
                        else if (action === 'stop') stopReading();
                    };
                    btn.addEventListener('click', handler);
                    btn.addEventListener('touchend', handler);
                });
            }
            const activeScreen = document.querySelector('.screen.active')?.id || '';
            const showOnScreens = ['theorySection','visualGuide','auditivaGuide'];
            if (window.innerWidth < 768 && showOnScreens.includes(activeScreen)) {
                mc.style.display = 'flex';
                mc.classList.add('show');
            } else {
                mc.style.display = 'none';
                mc.classList.remove('show');
            }
        }

        window.addEventListener('resize', () => {
            ensureMobileControls();
            updateFloatingDeviceControls();
        });
        document.addEventListener('DOMContentLoaded', () => {
            // Cargar voces disponibles
            if ('speechSynthesis' in window) {
                speechSynthesis.getVoices();
                if (speechSynthesis.onvoiceschanged !== undefined) {
                    speechSynthesis.onvoiceschanged = () => speechSynthesis.getVoices();
                }
            }
            ensureMobileControls();
            updateFloatingDeviceControls();
        });

        // Floating device controls (global, para teor√≠a y pr√°cticas)
        function createFloatingDeviceControls() {
            if (document.getElementById('deviceControlsFloating')) return;
            const div = document.createElement('div');
            div.id = 'deviceControlsFloating';
            div.className = 'device-controls device-controls-floating';
            div.innerHTML = `
                <button class="control-btn control-start" data-action="start" aria-label="Iniciar" style="background:#28a745;color:white;border:none;border-radius:8px;cursor:pointer;">‚ñ∂Ô∏è</button>
                <button class="control-btn control-pause" data-action="pause" aria-label="Pausar" style="background:#ffc107;color:#333;border:none;border-radius:8px;cursor:pointer;">‚è∏Ô∏è</button>
                <button class="control-btn control-resume" data-action="resume" aria-label="Reanudar" style="background:#17a2b8;color:white;border:none;border-radius:8px;cursor:pointer;">‚ñ∂Ô∏è</button>
                <button class="control-btn control-stop" data-action="stop" aria-label="Detener" style="background:#dc3545;color:white;border:none;border-radius:8px;cursor:pointer;">‚èπÔ∏è</button>
            `;
            document.body.appendChild(div);
            
            // Agregar event listeners
            div.querySelectorAll('button[data-action]').forEach(btn => {
                const handler = function(e) {
                    e.preventDefault();
                    const action = this.getAttribute('data-action');
                    if (action === 'start') startReadingCurrent();
                    else if (action === 'pause') pauseReading();
                    else if (action === 'resume') resumeReading();
                    else if (action === 'stop') stopReading();
                };
                btn.addEventListener('click', handler);
                btn.addEventListener('touchend', handler);
            });
        }

        function updateFloatingDeviceControls() {
            createFloatingDeviceControls();
            const preferred = (() => { try { return localStorage.getItem('preferredDevice'); } catch(e) { return null; } })();
            const floating = document.getElementById('deviceControlsFloating');
            if (!floating) return;
            
            const activeScreen = document.querySelector('.screen.active')?.id || '';
            const showOnScreens = ['theorySection','visualGuide','auditivaGuide'];
            const isMobileSize = window.innerWidth < 768;
            const shouldShow = (preferred === 'mobile' || isMobileSize) && showOnScreens.includes(activeScreen);
            
            if (shouldShow) {
                floating.style.display = 'flex';
                floating.setAttribute('aria-hidden','false');
            } else {
                floating.style.display = 'none';
                floating.setAttribute('aria-hidden','true');
            }
        }

        // positionFloatingNear ya no se usa; los controles flotantes son fijos en centro-derecha

        // Al cargar, si hay preferencia previa, aplicarla a las pantallas de setup
        document.addEventListener('DOMContentLoaded', () => {
            // Inicializar event listeners
            initializeEventListeners();
            
            // Event listener para bot√≥n flotante
            const floatingBtn = document.getElementById('floatingHomeBtn');
            if (floatingBtn) {
                floatingBtn.addEventListener('click', () => showScreen('mainMenu'));
                floatingBtn.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    showScreen('mainMenu');
                });
            }
            
            // Inicializar controles m√≥viles
            ensureMobileControls();
            updateFloatingDeviceControls();
            
            // Aplicar preferencias guardadas
            try {
                const pref = localStorage.getItem('preferredDevice');
                if (pref) {
                    // intentar marcar las tarjetas correspondientes si est√°n presentes
                    const v = document.querySelector('#visualSetup .device-card[data-device="' + pref + '"]');
                    if (v) selectVisualDevice(v);
                    const a = document.querySelector('#auditivaSetup .device-card[data-device="' + pref + '"]');
                    if (a) selectAuditivaDevice(a);
                }
            } catch(e) {}
        });

        function printVisualGuide() {
            window.print();
        }

        // Manejo de subida de im√°genes
        function setupImageUpload(inputId, containerId) {
            const input = document.getElementById(inputId);
            const container = document.getElementById(containerId);
            
            if (!input || !container) return;
            
            input.addEventListener('change', function(e) {
                const files = Array.from(e.target.files);
                
                files.forEach(file => {
                    if (file.type.startsWith('image/')) {
                        const reader = new FileReader();
                        
                        reader.onload = function(event) {
                            const imageDiv = document.createElement('div');
                            imageDiv.className = 'uploaded-image-item';
                            
                            const img = document.createElement('img');
                            img.src = event.target.result;
                            img.alt = file.name;
                            
                            const removeBtn = document.createElement('button');
                            removeBtn.className = 'remove-image-btn';
                            removeBtn.innerHTML = '‚úï';
                            removeBtn.onclick = function() {
                                imageDiv.remove();
                            };
                            
                            imageDiv.appendChild(img);
                            imageDiv.appendChild(removeBtn);
                            container.appendChild(imageDiv);
                        };
                        
                        reader.readAsDataURL(file);
                    }
                });
                
                // Limpiar input para permitir subir la misma imagen nuevamente
                e.target.value = '';
            });
        }

        // Habilitar botones cuando se llenen los formularios
        document.addEventListener('DOMContentLoaded', () => {
            const visualName = document.getElementById('visualName');
            const visualSection = document.getElementById('visualSection');
            const auditivaName = document.getElementById('auditivaName');
            const auditivaSection = document.getElementById('auditivaSection');
            
            if (visualName) visualName.addEventListener('input', updateVisualStartState);
            if (visualSection) visualSection.addEventListener('input', updateVisualStartState);
            if (auditivaName) auditivaName.addEventListener('input', updateAuditivaStartState);
            if (auditivaSection) auditivaSection.addEventListener('input', updateAuditivaStartState);
            
            // Inicializar subida de im√°genes
            setupImageUpload('imageUploadVisual1', 'imagesVisual1');
        });
    </script>

</body>
</html>